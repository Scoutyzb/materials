<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--360浏览器优先以webkit内核解析-->


    <title>首页</title>

    <!--<link rel="shortcut icon" href="favicon.ico">-->
    <link href="css/admin/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="css/admin/font-awesome.css?v=4.4.0" rel="stylesheet">

    <link href="css/admin/animate.css" rel="stylesheet">
    <link href="css/admin/style.css?v=4.1.0" rel="stylesheet">

    <!-- echarts JS -->
    <script src="js/admin/media/echarts.js"></script>

    <!-- 全局js -->
    <script src="js/admin/jquery.min.js?v=2.1.4"></script>
    <script src="js/admin/bootstrap.min.js?v=3.3.6"></script>
    <script src="js/plugins/layer/layer.min.js"></script>
    <!-- Flot -->
    <script src="js/admin/plugins/flot/jquery.flot.js"></script>
    <script src="js/admin/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="js/admin/plugins/flot/jquery.flot.resize.js"></script>
    <script src="js/admin/plugins/flot/jquery.flot.pie.js"></script>
    <!-- 自定义js -->
    <script src="js/admin/content.js"></script>
</head>

<body class="gray-bg">
<div class="wrapper wrapper-content">
    <input type="hidden" id="base" value="${basePath}"/>
    <div class="row">
        <div class="col-sm-3">
            <div class="row">
                <div class="col-sm-12">
                    <div class="row row-sm text-center">
                        <div class="col-xs-10">
                            <div class="panel padder-v item">
                                <div class="h1 text-info font-thin">
                                    <a href="#"></a>
                                </div>
                                <span class="text-muted text-xs">用户情况</span>
                                <div class="top text-right w-full">
                                    <i class="fa fa-caret-down text-warning m-r-sm"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <div class="row row-sm text-center">
                        <div class="col-xs-10">
                            <div class="panel padder-v item">
                                <div class="font-thin h1">
                                    <a href="#"></a>
                                </div>
                                <span class="text-muted text-xs">待审核上传内容</span>
                                <div class="top text-right w-full">
                                    <i class="fa fa-caret-down text-warning m-r-sm"></i>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
        <div class="col-sm-9">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>任务列表</h5>
                </div>
                <div class="ibox-content">
                    <ul class="todo-list m-t small-list ui-sortable">
                        <!--待处理cif-->
                        <li>
                            <a href="#"
                               class="check-link"><i class="fa fa-square-o"></i> </a>
                            <span>用户上传cif</span>
                            <small class="label label-primary"><i class="fa fa-clock-o"></i> ${ls.time}</small>
                        </li>
                        <!--待处理出版物-->
                        <li>
                            <a href="#"
                               class="check-link"><i class="fa fa-square-o"></i> </a>
                            <span>用户上传出版物</span>
                            <small class="label label-primary"><i class="fa fa-clock-o"></i> 上传时间</small>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
    <script type="text/javascript">

    </script>

    <script type="text/javascript">

        //近一周待处理事件/问题数呈现
        $(document).ready(
            function () {
                var categories = [];
                var eventCount = [];
                var problemCount = [];
                $.ajax({
                    type: "POST",
                    url: "eventAndProblem",
                    dataType: "json",
                    success: function (data) {
                        for (var i in data.time) {
                            categories[i] = data.time[i].time;
                            eventCount[i] = data.time[i].eventCount;
                            problemCount[i] = data.time[i].problemCount;
                        }
                        var myChart = echarts.init(document.getElementById("echarts-line-chart"));
                        option = {
                            title: {
                                // text: '近一周待处理事件/问题数',
                                //subtext: '纯属虚构'
                            },
                            tooltip: {
                                trigger: 'axis'
                            },
                            legend: {
                                data: ['待处理事件数', '待处理问题数']
                            },
                            toolbox: {
                                show: true,
                                feature: {
                                    dataZoom: {
                                        yAxisIndex: 'none'
                                    },
                                    dataView: {readOnly: false},
                                    magicType: {type: ['line', 'bar']},
                                    restore: {},
                                    saveAsImage: {}
                                }
                            },
                            xAxis: {
                                type: 'category',
                                boundaryGap: false,
                                data: categories
                            },
                            yAxis: {
                                type: 'value',
                                axisLabel: {
                                    formatter: '{value}'
                                }
                            },
                            series: [
                                {
                                    name: '待处理事件数',
                                    type: 'line',
                                    data: eventCount,
                                    markPoint: {
                                        data: [
                                            {type: 'max', name: '最大值'},
                                            {type: 'min', name: '最小值'}
                                        ]
                                    },
                                    markLine: {
                                        data: [
                                            {type: 'average', name: '平均值'}
                                        ]
                                    }
                                },
                                {
                                    name: '待处理问题数',
                                    type: 'line',
                                    data: problemCount,
                                    markPoint: {
                                        data: [
                                            {name: '周最低', value: -2, xAxis: 1, yAxis: -1.5}
                                        ]
                                    },
                                    markLine: {
                                        data: [
                                            {type: 'average', name: '平均值'},
                                            [{
                                                symbol: 'none',
                                                x: '90%',
                                                yAxis: 'max'
                                            }, {
                                                symbol: 'circle',
                                                label: {
                                                    normal: {
                                                        position: 'start',
                                                        formatter: '最大值'
                                                    }
                                                },
                                                type: 'max',
                                                name: '最高点'
                                            }]
                                        ]
                                    }
                                }
                            ]
                        };

                        myChart.setOption(option);
                    }
                });
            })

    </script>
    <script type="text/javascript">

        $(document).ready(
            function () {
                var names = [];    //类别数组（用于存放饼图的类别）
                var brower = [];
                $.ajax({
                    type: "POST",
                    url: "classifyCount",
                    dataType: "json",
                    success: function (data) {
                        //请求成功时执行该函数内容，result即为服务器返回的json对象
                        $.each(data.classifyList, function (index, item) {
                            // names.push(item.classifyName);    //挨个取出类别并填入类别数组
                            brower.push({
                                name: item.classifyName,
                                value: item.classifyCount
                            });
                        });

                        var myChart = echarts.init(document.getElementById("echarts-pie-chart"));

                        option1 = {
                            title: {
                                text: 'FAQ分类情况',
                                //subtext: '纯属虚构',
                                x: 'center'
                            },
                            tooltip: {
                                trigger: 'item',
                                formatter: "{a} <br/>{b} : {c} ({d}%)"
                            },
                            legend: {
                                orient: 'vertical',
                                left: 'left',
                                //data: names
                            },
                            series: [
                                {
                                    name: '分类名',
                                    type: 'pie',
                                    radius: '55%',
                                    center: ['50%', '60%'],
                                    data:

                                    brower
                                    ,
                                    itemStyle: {
                                        emphasis: {
                                            shadowBlur: 10,
                                            shadowOffsetX: 0,
                                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                                        }
                                    }
                                }
                            ]
                        };

                        myChart.setOption(option1);
                    }
                });
            })

        var myChart2 = echarts.init(document.getElementById("echarts-pie-chart"));
        myChart2.on('click', function () {
            window.location.href = base + "/faqPage.html";
        });
    </script>

    <script>

        $(document).ready(
            function () {
                var categories = [];    //用于存放地区名（用于存放饼图的类别）
                var eventCount = [];	//存放各地区设备数量
                $.ajax({
                    type: "POST",
                    url: "regionCount",
                    dataType: "json",
                    success: function (data) {
                        //请求成功时执行该函数内容，result即为服务器返回的json对象
                        console.log(data)
                        for (var i in data.regionList) {
                            categories[i] = data.regionList[i].regions;
                            eventCount[i] = data.regionList[i].equipmentCounts;

                        }

                        var myChart = echarts.init(document.getElementById("equipments"));


                        option3 = {
                            color: ['#3398DB'],
                            tooltip: {
                                trigger: 'axis',
                                axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                                }
                            },
                            grid: {
                                left: '3%',
                                right: '4%',
                                bottom: '3%',
                                containLabel: true
                            },
                            xAxis: [
                                {
                                    type: 'category',
                                    data: categories,
                                    axisTick: {
                                        alignWithLabel: true
                                    }
                                }
                            ],
                            yAxis: [
                                {
                                    type: 'value'
                                }
                            ],
                            series: [
                                {
                                    name: '设备数量',
                                    type: 'bar',
                                    barWidth: '60%',
                                    data: eventCount
                                }
                            ]
                        };


                        myChart.setOption(option3);
                    }
                });
            })
        var myChart1 = echarts.init(document.getElementById("equipments"));
        myChart1.on('click', function () {
            window.location.href = base + "/configureEquipmentPage.html";
        });

    </script>


</body>

</html>